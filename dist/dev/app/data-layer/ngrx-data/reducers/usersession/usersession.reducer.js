"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ProfileActionTypes = require("../../../../business-layer/shared-types/actions/profile.action.types");
var UserSessionActionTypes = require("../../../../business-layer/shared-types/actions/usersession.action.types");
exports.initialState = {
    user: {},
    token: '',
    errorMessage: '',
    loading: false,
    loaded: false
};
function reducer(state, action) {
    if (state === void 0) { state = exports.initialState; }
    switch (action.type) {
        case ProfileActionTypes.REGISTER_USER_ATTEMPT:
        case UserSessionActionTypes.LOGIN_USER_ATTEMPT:
        case UserSessionActionTypes.APP_START_CLEAR_LOGIN: {
            localStorage.clear();
            return Object.assign({}, state, { user: {}, token: '', loading: false, loaded: false, errorMessage: '' });
        }
        case ProfileActionTypes.REGISTER_USER_SUCCESS:
        case UserSessionActionTypes.LOGIN_USER_SUCCESS: {
            if (action.payload.hasOwnProperty('user')) {
                var user = (action.payload.user);
                var session = action.payload;
                if (state.user.hasOwnProperty('id') && (state.user.id === session.user.id)) {
                    return state;
                }
                localStorage.setItem('Authorized', session.token);
                return Object.assign({}, state, session, { loading: false, loaded: true, errorMessage: '' });
            }
            else {
                return state;
            }
        }
        case UserSessionActionTypes.GET_SESSION_USER_SUCCESS: {
            var session = action.payload;
            if (state.user.hasOwnProperty('id') && (state.user.id === session.user.id)) {
                return state;
            }
            return Object.assign({}, state, session);
        }
        case UserSessionActionTypes.LOGOUT_USER_SUCCESS: {
            localStorage.clear();
            return Object.assign({}, state, { user: {}, token: '', loading: false, loaded: false, errorMessage: '' });
        }
        case UserSessionActionTypes.LOGIN_USER_FAILURE: {
            return Object.assign({}, { user: {},
                token: '',
                loading: false,
                loaded: false,
                errorMessage: action.payload.message });
        }
        default: {
            return state;
        }
    }
}
exports.reducer = reducer;
exports.getUser = function (state) { return state.user; };
exports.getToken = function (state) { return state.token; };
exports.getUserLoading = function (state) { return state.loading; };
exports.getUserLoaded = function (state) { return state.loaded; };

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9kYXRhLWxheWVyL25ncngtZGF0YS9yZWR1Y2Vycy91c2Vyc2Vzc2lvbi91c2Vyc2Vzc2lvbi5yZWR1Y2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBS0EseUdBQTJHO0FBQzNHLGlIQUFtSDtBQVl0RyxRQUFBLFlBQVksR0FBVTtJQUNqQyxJQUFJLEVBQUUsRUFBRTtJQUNSLEtBQUssRUFBQyxFQUFFO0lBQ1IsWUFBWSxFQUFDLEVBQUU7SUFDZixPQUFPLEVBQUUsS0FBSztJQUNkLE1BQU0sRUFBQyxLQUFLO0NBQ2IsQ0FBQztBQUlGLGlCQUF3QixLQUFvQixFQUFFLE1BQWlEO0lBQXZFLHNCQUFBLEVBQUEsNEJBQW9CO0lBQzFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ3BCLEtBQUssa0JBQWtCLENBQUMscUJBQXFCLENBQUM7UUFDOUMsS0FBSyxzQkFBc0IsQ0FBQyxrQkFBa0IsQ0FBQztRQUMvQyxLQUFLLHNCQUFzQixDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFDOUMsWUFBWSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ3JCLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBQyxJQUFJLEVBQUMsRUFBRSxFQUFFLEtBQUssRUFBQyxFQUFFLEVBQUUsT0FBTyxFQUFDLEtBQUssRUFBRSxNQUFNLEVBQUMsS0FBSyxFQUFFLFlBQVksRUFBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzFHLENBQUM7UUFDRCxLQUFLLGtCQUFrQixDQUFDLHFCQUFxQixDQUFDO1FBQzlDLEtBQUssc0JBQXNCLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUMzQyxFQUFFLENBQUEsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hDLElBQU0sSUFBSSxHQUF3QixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ3hELElBQU0sT0FBTyxHQUErQixNQUFNLENBQUMsT0FBTyxDQUFDO2dCQUMzRCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUMxRSxNQUFNLENBQUMsS0FBSyxDQUFDO2dCQUNoQixDQUFDO2dCQUNELFlBQVksQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDbkQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsRUFBQyxPQUFPLEVBQUMsS0FBSyxFQUFFLE1BQU0sRUFBQyxJQUFJLEVBQUcsWUFBWSxFQUFDLEVBQUUsRUFBQyxDQUFDLENBQUM7WUFDNUYsQ0FBQztZQUFBLElBQUksQ0FBQyxDQUFDO2dCQUNILE1BQU0sQ0FBQyxLQUFLLENBQUM7WUFDakIsQ0FBQztRQUNQLENBQUM7UUFFRCxLQUFLLHNCQUFzQixDQUFDLHdCQUF3QixFQUFFLENBQUM7WUFDbEQsSUFBTSxPQUFPLEdBQThCLE1BQU0sQ0FBQyxPQUFPLENBQUM7WUFDMUQsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDMUUsTUFBTSxDQUFDLEtBQUssQ0FBQztZQUNoQixDQUFDO1lBQ0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUM5QyxDQUFDO1FBRUQsS0FBSyxzQkFBc0IsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1lBQzVDLFlBQVksQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNyQixNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUMsRUFBRSxFQUFFLE9BQU8sRUFBQyxLQUFLLEVBQUUsTUFBTSxFQUFDLEtBQUssRUFBRyxZQUFZLEVBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUMzRyxDQUFDO1FBRUQsS0FBSyxzQkFBc0IsQ0FBQyxrQkFBa0IsRUFBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBQyxFQUFFO2dCQUNQLEtBQUssRUFBQyxFQUFFO2dCQUNSLE9BQU8sRUFBQyxLQUFLO2dCQUNiLE1BQU0sRUFBQyxLQUFLO2dCQUNaLFlBQVksRUFBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBQyxDQUFDLENBQUM7UUFDdkUsQ0FBQztRQUVELFNBQVMsQ0FBQztZQUNSLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDZixDQUFDO0lBQ0gsQ0FBQztBQUNILENBQUM7QUFoREQsMEJBZ0RDO0FBRVksUUFBQSxPQUFPLEdBQUcsVUFBQyxLQUFXLElBQUssT0FBQSxLQUFLLENBQUMsSUFBSSxFQUFWLENBQVUsQ0FBQztBQUV0QyxRQUFBLFFBQVEsR0FBRyxVQUFDLEtBQVcsSUFBSyxPQUFBLEtBQUssQ0FBQyxLQUFLLEVBQVgsQ0FBVyxDQUFDO0FBRXhDLFFBQUEsY0FBYyxHQUFHLFVBQUMsS0FBVyxJQUFLLE9BQUEsS0FBSyxDQUFDLE9BQU8sRUFBYixDQUFhLENBQUM7QUFFaEQsUUFBQSxhQUFhLEdBQUcsVUFBQyxLQUFXLElBQUssT0FBQSxLQUFLLENBQUMsTUFBTSxFQUFaLENBQVksQ0FBQyIsImZpbGUiOiJhcHAvZGF0YS1sYXllci9uZ3J4LWRhdGEvcmVkdWNlcnMvdXNlcnNlc3Npb24vdXNlcnNlc3Npb24ucmVkdWNlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFVzZXJNb2RlbCAgfSBmcm9tICcuLi8uLi8uLi8uLi9idXNpbmVzcy1sYXllci9tb2RlbHMvdXNlci5tb2RlbCc7XG5pbXBvcnQgeyBTZXNzaW9uTW9kZWwgIH0gZnJvbSAnLi4vLi4vLi4vLi4vYnVzaW5lc3MtbGF5ZXIvbW9kZWxzL3Nlc3Npb24ubW9kZWwnO1xuaW1wb3J0ICogYXMgdXNlclNlc3Npb24gZnJvbSAnLi4vLi4vYWN0aW9ucy91c2Vyc2Vzc2lvbi5hY3Rpb25zJztcbmltcG9ydCAqIGFzIHVzZXJQcm9maWxlIGZyb20gJy4uLy4uL2FjdGlvbnMvcHJvZmlsZS5hY3Rpb25zJztcblxuaW1wb3J0ICogYXMgUHJvZmlsZUFjdGlvblR5cGVzIGZyb20gJy4uLy4uLy4uLy4uL2J1c2luZXNzLWxheWVyL3NoYXJlZC10eXBlcy9hY3Rpb25zL3Byb2ZpbGUuYWN0aW9uLnR5cGVzJztcbmltcG9ydCAqIGFzIFVzZXJTZXNzaW9uQWN0aW9uVHlwZXMgZnJvbSAnLi4vLi4vLi4vLi4vYnVzaW5lc3MtbGF5ZXIvc2hhcmVkLXR5cGVzL2FjdGlvbnMvdXNlcnNlc3Npb24uYWN0aW9uLnR5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBTdGF0ZSB7XG4gIHVzZXI6IFVzZXJNb2RlbDtcbiAgdG9rZW46IHN0cmluZyB8bnVsbDtcbiAgbG9hZGluZzogYm9vbGVhbjtcbiAgbG9hZGVkOmJvb2xlYW47XG4gIGVycm9yTWVzc2FnZTpzdHJpbmcgfG51bGw7XG59XG5cblxuXG5leHBvcnQgY29uc3QgaW5pdGlhbFN0YXRlOiBTdGF0ZSA9IHtcbiAgdXNlcjoge30sXG4gIHRva2VuOicnLFxuICBlcnJvck1lc3NhZ2U6JycsXG4gIGxvYWRpbmc6IGZhbHNlLFxuICBsb2FkZWQ6ZmFsc2Vcbn07XG5cblxuXG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlcihzdGF0ZSA9IGluaXRpYWxTdGF0ZSwgYWN0aW9uOiB1c2VyU2Vzc2lvbi5BY3Rpb25zIHwgdXNlclByb2ZpbGUuQWN0aW9ucyk6IFN0YXRlIHtcbiAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgIGNhc2UgUHJvZmlsZUFjdGlvblR5cGVzLlJFR0lTVEVSX1VTRVJfQVRURU1QVDpcbiAgICBjYXNlIFVzZXJTZXNzaW9uQWN0aW9uVHlwZXMuTE9HSU5fVVNFUl9BVFRFTVBUOlxuICAgIGNhc2UgVXNlclNlc3Npb25BY3Rpb25UeXBlcy5BUFBfU1RBUlRfQ0xFQVJfTE9HSU46IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHt1c2VyOnt9LCB0b2tlbjonJywgbG9hZGluZzpmYWxzZSwgbG9hZGVkOmZhbHNlLCBlcnJvck1lc3NhZ2U6JycgfSk7XG4gICAgfVxuICAgIGNhc2UgUHJvZmlsZUFjdGlvblR5cGVzLlJFR0lTVEVSX1VTRVJfU1VDQ0VTUzpcbiAgICBjYXNlIFVzZXJTZXNzaW9uQWN0aW9uVHlwZXMuTE9HSU5fVVNFUl9TVUNDRVNTOiB7XG4gICAgICAgICAgaWYoYWN0aW9uLnBheWxvYWQuaGFzT3duUHJvcGVydHkoJ3VzZXInKSkge1xuICAgICAgICAgICAgIGNvbnN0IHVzZXI6VXNlck1vZGVsID0gPFVzZXJNb2RlbD4oYWN0aW9uLnBheWxvYWQudXNlcik7XG4gICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbjpTZXNzaW9uTW9kZWwgPSA8U2Vzc2lvbk1vZGVsPiBhY3Rpb24ucGF5bG9hZDtcbiAgICAgICAgICAgICBpZiAoc3RhdGUudXNlci5oYXNPd25Qcm9wZXJ0eSgnaWQnKSAmJiAoc3RhdGUudXNlci5pZCA9PT0gc2Vzc2lvbi51c2VyLmlkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0F1dGhvcml6ZWQnLCAgc2Vzc2lvbi50b2tlbik7XG4gICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLCBzZXNzaW9uLCB7bG9hZGluZzpmYWxzZSwgbG9hZGVkOnRydWUsICBlcnJvck1lc3NhZ2U6Jyd9KTtcbiAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FzZSBVc2VyU2Vzc2lvbkFjdGlvblR5cGVzLkdFVF9TRVNTSU9OX1VTRVJfU1VDQ0VTUzoge1xuICAgICAgICAgY29uc3Qgc2Vzc2lvbjpTZXNzaW9uTW9kZWw9IDxTZXNzaW9uTW9kZWw+IGFjdGlvbi5wYXlsb2FkO1xuICAgICAgICAgaWYgKHN0YXRlLnVzZXIuaGFzT3duUHJvcGVydHkoJ2lkJykgJiYgKHN0YXRlLnVzZXIuaWQgPT09IHNlc3Npb24udXNlci5pZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgICAgIH1cbiAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZSwgc2Vzc2lvbik7XG4gICAgfVxuXG4gICAgY2FzZSBVc2VyU2Vzc2lvbkFjdGlvblR5cGVzLkxPR09VVF9VU0VSX1NVQ0NFU1M6IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHt1c2VyOnt9LCB0b2tlbjonJywgbG9hZGluZzpmYWxzZSwgbG9hZGVkOmZhbHNlLCAgZXJyb3JNZXNzYWdlOicnIH0pO1xuICAgIH1cblxuICAgIGNhc2UgVXNlclNlc3Npb25BY3Rpb25UeXBlcy5MT0dJTl9VU0VSX0ZBSUxVUkU6e1xuICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB7IHVzZXI6e30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW46JycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzpmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6ZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOmFjdGlvbi5wYXlsb2FkLm1lc3NhZ2V9KTtcbiAgICB9XG5cbiAgICBkZWZhdWx0OiB7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VyID0gKHN0YXRlOlN0YXRlKSA9PiBzdGF0ZS51c2VyO1xuXG5leHBvcnQgY29uc3QgZ2V0VG9rZW4gPSAoc3RhdGU6U3RhdGUpID0+IHN0YXRlLnRva2VuO1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlckxvYWRpbmcgPSAoc3RhdGU6U3RhdGUpID0+IHN0YXRlLmxvYWRpbmc7XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VyTG9hZGVkID0gKHN0YXRlOlN0YXRlKSA9PiBzdGF0ZS5sb2FkZWQ7XG4iXX0=
